import React, { useState, useEffect } from 'react';
import Link from 'next/link';
import { useSelector, useDispatch } from 'react-redux';

import styles from './HeaderCollection.module.scss';

const SaveIdLog = () => {;
  const paruresAddedToCart = useSelector((state) => state.paruresAddedToCart);
  const dispatch = useDispatch();
  const disconnect = (idLogLocal) => dispatch({
    type: 'disconnect',
    idLog: idLogLocal
  });
  return {
   disconnect, paruresAddedToCart
  };
};

const HeaderCollection = (props) => {
  const { disconnect, paruresAddedToCart }  = SaveIdLog()
  const [shareCard, setShareCard] = useState(false);
  const [connectionBar, setConnectionBar] = useState(false);
  const [callBackMail, setCallBackMail] = useState(false);

  const [somethingInCart, setSomethingInCart] = useState(paruresAddedToCart);
  // useEffect(() => {
  //   setSomethingInCart(paruresAddedToCart);
  //   console.log('hihi')
  // }, [paruresAddedToCart])

  return (
    <div className={styles.headerCollection}>
      {shareCard ? (
        <div className={styles.popShareCard}>
          <div className={styles.triangle} />
          <div className={styles.shareCard}>
            <div className={styles.basicText}>
              Entrez l'adresse mail du destinataire
            </div>
            <div className={styles.mail}>
              <input type="email" name="" id="" className={styles.mailInput} />
            </div>
            <div className={styles.groupButtonsRow}>
              <button type="button" className={styles.buttonBottom} onClick={() => resetCard()}>
                Retour
              </button>
              <button type="button" className={styles.buttonTop} onClick={() => {resetCard(), popCallBackMail()}}>
                Envoyer
              </button>
            </div>
          </div>
        </div>
      ) : null}

      {callBackMail ? (
        <div className={`${styles.popShareCard} ${styles.callBackMail}`}>
          <div className={styles.triangle} />
          <div className={styles.shareCard}>
            <div className={styles.basicText}>
              <img src="/static/icons/iconCheckGrey.svg" />
              Selection envoyée
            </div>
          </div>
        </div>
      ) : null}

      {connectionBar && props.idLog ? (
        <div className={styles.connectionBar}>
          <div className={styles.triangle} />
          <div className={styles.basicText}>
            Voulez-vous quitter cette sélection ?
          </div>
          <div className={styles.groupButtonsRow}>
            <button type="button" className={styles.buttonBottom} onClick={() => { resetCard(); }}>
              Retour
            </button>
            <Link href="/">
              <button type="button" className={styles.buttonTop} onClick={() => {disconnect(""), props.setActiveParure}}>
                Se déconnecter
              </button>
            </Link>
          </div>
        </div>
      ) : null}



      <Link href="/">
        <div className={styles.back}>
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11.5964 15.6902C12.0013 15.6902 12.4063 15.6902 12.8141 15.693C13.7758 15.693 14.7348 15.6958 15.6966 15.6958C16.8327 15.6986 17.9689 15.6986 19.105 15.7014C20.019 15.7014 20.933 15.7042 21.847 15.7042C22.356 15.7042 22.8706 15.6902 23.3796 15.7239C23.5646 15.7346 23.7368 15.7492 23.7368 15.7492C24.4792 15.8505 25.2076 16.0473 25.8994 16.337C25.8319 16.3088 25.7644 16.2807 25.6969 16.2526C26.0991 16.4213 26.4872 16.621 26.8612 16.8488C27.0412 16.9585 27.2155 17.0766 27.3871 17.1975C27.5149 17.2888 27.6395 17.3842 27.7583 17.4872C28.0845 17.7628 28.3882 18.0609 28.6695 18.3815C28.7398 18.4602 28.8073 18.5418 28.8719 18.6205C28.9029 18.6599 28.9338 18.6964 28.9647 18.7358C28.9872 18.7639 29.0435 18.8371 28.9563 18.7246C28.8579 18.598 28.9479 18.7133 28.9704 18.7414C29.0997 18.9158 29.2235 19.093 29.3388 19.2758C29.6003 19.6863 29.8253 20.1166 30.0137 20.5638C29.9856 20.4963 29.9575 20.4288 29.9293 20.3613C30.219 21.0531 30.4159 21.7787 30.5171 22.5239C30.5059 22.448 30.4974 22.3748 30.4862 22.2989C30.5846 23.0526 30.5846 23.8147 30.4862 24.5684C30.4974 24.4925 30.5059 24.4193 30.5171 24.3434C30.4159 25.0858 30.219 25.8142 29.9293 26.506C29.9575 26.4385 29.9856 26.371 30.0137 26.3035C29.845 26.7057 29.6453 27.0938 29.4175 27.4678C29.3078 27.6478 29.1897 27.8222 29.0688 27.9937C29.0407 28.0331 29.0097 28.0753 28.9816 28.1146C28.9619 28.1399 28.9451 28.1624 28.9254 28.1877C28.8663 28.2665 29.0491 28.0274 28.9901 28.1062C28.9197 28.1934 28.8523 28.2805 28.7791 28.3649C28.5035 28.6911 28.2054 28.9949 27.8848 29.2761C27.8061 29.3464 27.7246 29.4139 27.6458 29.4786C27.6064 29.5095 27.5699 29.5404 27.5305 29.5714C27.5024 29.5939 27.4293 29.6501 27.5418 29.5629C27.6683 29.4645 27.553 29.5545 27.5249 29.577C27.3505 29.7064 27.1734 29.8301 26.9906 29.9454C26.58 30.2069 26.1497 30.4319 25.7026 30.6203C25.77 30.5922 25.8375 30.5641 25.905 30.536C25.2132 30.8256 24.4877 31.0225 23.7424 31.1237C23.8183 31.1125 23.8915 31.104 23.9674 31.0928C23.2896 31.1828 22.6063 31.1687 21.9257 31.1687C20.9189 31.1687 19.9121 31.1687 18.9054 31.1687C17.6089 31.1687 16.3097 31.1687 15.0132 31.1687C13.863 31.1687 12.7128 31.1687 11.5626 31.1687C10.9974 31.1687 10.4321 31.1575 9.86964 31.1687C9.86121 31.1687 9.85277 31.1687 9.84433 31.1687C9.40281 31.1687 8.98098 31.5568 9.00066 32.0124C9.02035 32.4708 9.37188 32.8561 9.84433 32.8561C10.6936 32.8561 11.5457 32.8561 12.395 32.8561C14.1527 32.8561 15.9075 32.8561 17.6652 32.8561C19.1332 32.8561 20.6011 32.8561 22.0719 32.8561C22.325 32.8561 22.5782 32.8561 22.8313 32.8561C24.1811 32.8532 25.4944 32.5523 26.7262 32.004C29.1363 30.9297 31.0008 28.7839 31.8107 26.2839C32.6432 23.7163 32.2804 20.8112 30.8602 18.5193C29.4738 16.2779 27.1396 14.6299 24.5327 14.1715C23.3375 13.9606 22.1198 14.0112 20.9105 14.0112C19.1753 14.0084 17.4374 14.0056 15.7022 14.0056C14.403 14.0028 13.1065 14.0028 11.8073 14C11.7398 14 11.6695 14 11.602 14C11.1605 14 10.7386 14.3881 10.7583 14.8437C10.7752 15.3049 11.1239 15.6902 11.5964 15.6902Z" fill="white" />
            <path d="M18.5779 20.7182C17.827 19.9617 17.0733 19.2052 16.3225 18.4459C15.1301 17.2479 13.9405 16.0471 12.7481 14.8491C12.4725 14.5707 12.1969 14.2951 11.9213 14.0167C11.9213 14.4132 11.9213 14.8125 11.9213 15.209C12.675 14.461 13.4287 13.7129 14.1796 12.9649C15.3719 11.7809 16.5643 10.597 17.7539 9.41303C18.0267 9.14024 18.3023 8.86745 18.5751 8.59748C18.8901 8.28532 18.9097 7.71162 18.5751 7.40509C18.2376 7.09574 17.7173 7.07324 17.3827 7.40509C16.629 8.15314 15.8753 8.9012 15.1245 9.64925C13.9321 10.8332 12.7397 12.0172 11.5501 13.2011C11.2773 13.4739 11.0017 13.7467 10.7289 14.0167C10.4055 14.3373 10.4083 14.8856 10.7289 15.209C11.4798 15.9655 12.2335 16.722 12.9844 17.4813C14.1767 18.6794 15.3663 19.8802 16.5587 21.0782C16.8343 21.3566 17.1099 21.6322 17.3855 21.9106C17.6977 22.2228 18.2714 22.2453 18.5779 21.9106C18.8872 21.576 18.9097 21.0529 18.5779 20.7182Z" fill="white" />
            <path d="M11.5964 15.6902C12.0013 15.6902 12.4063 15.6902 12.8141 15.693C13.7758 15.693 14.7348 15.6958 15.6966 15.6958C16.8327 15.6986 17.9689 15.6986 19.105 15.7014C20.019 15.7014 20.933 15.7042 21.847 15.7042C22.356 15.7042 22.8706 15.6902 23.3796 15.7239C23.5646 15.7346 23.7368 15.7492 23.7368 15.7492C24.4792 15.8505 25.2076 16.0473 25.8994 16.337C25.8319 16.3088 25.7644 16.2807 25.6969 16.2526C26.0991 16.4213 26.4872 16.621 26.8612 16.8488C27.0412 16.9585 27.2155 17.0766 27.3871 17.1975C27.5149 17.2888 27.6395 17.3842 27.7583 17.4872C28.0845 17.7628 28.3882 18.0609 28.6695 18.3815C28.7398 18.4602 28.8073 18.5418 28.8719 18.6205C28.9029 18.6599 28.9338 18.6964 28.9647 18.7358C28.9872 18.7639 29.0435 18.8371 28.9563 18.7246C28.8579 18.598 28.9479 18.7133 28.9704 18.7414C29.0997 18.9158 29.2235 19.093 29.3388 19.2758C29.6003 19.6863 29.8253 20.1166 30.0137 20.5638C29.9856 20.4963 29.9575 20.4288 29.9293 20.3613C30.219 21.0531 30.4159 21.7787 30.5171 22.5239C30.5059 22.448 30.4974 22.3748 30.4862 22.2989C30.5846 23.0526 30.5846 23.8147 30.4862 24.5684C30.4974 24.4925 30.5059 24.4193 30.5171 24.3434C30.4159 25.0858 30.219 25.8142 29.9293 26.506C29.9575 26.4385 29.9856 26.371 30.0137 26.3035C29.845 26.7057 29.6453 27.0938 29.4175 27.4678C29.3078 27.6478 29.1897 27.8222 29.0688 27.9937C29.0407 28.0331 29.0097 28.0753 28.9816 28.1146C28.9619 28.1399 28.9451 28.1624 28.9254 28.1877C28.8663 28.2665 29.0491 28.0274 28.9901 28.1062C28.9197 28.1934 28.8523 28.2805 28.7791 28.3649C28.5035 28.6911 28.2054 28.9949 27.8848 29.2761C27.8061 29.3464 27.7246 29.4139 27.6458 29.4786C27.6064 29.5095 27.5699 29.5404 27.5305 29.5714C27.5024 29.5939 27.4293 29.6501 27.5418 29.5629C27.6683 29.4645 27.553 29.5545 27.5249 29.577C27.3505 29.7064 27.1734 29.8301 26.9906 29.9454C26.58 30.2069 26.1497 30.4319 25.7026 30.6203C25.77 30.5922 25.8375 30.5641 25.905 30.536C25.2132 30.8256 24.4877 31.0225 23.7424 31.1237C23.8183 31.1125 23.8915 31.104 23.9674 31.0928C23.2896 31.1828 22.6063 31.1687 21.9257 31.1687C20.9189 31.1687 19.9121 31.1687 18.9054 31.1687C17.6089 31.1687 16.3097 31.1687 15.0132 31.1687C13.863 31.1687 12.7128 31.1687 11.5626 31.1687C10.9974 31.1687 10.4321 31.1575 9.86964 31.1687C9.86121 31.1687 9.85277 31.1687 9.84433 31.1687C9.40281 31.1687 8.98098 31.5568 9.00066 32.0124C9.02035 32.4708 9.37188 32.8561 9.84433 32.8561C10.6936 32.8561 11.5457 32.8561 12.395 32.8561C14.1527 32.8561 15.9075 32.8561 17.6652 32.8561C19.1332 32.8561 20.6011 32.8561 22.0719 32.8561C22.325 32.8561 22.5782 32.8561 22.8313 32.8561C24.1811 32.8532 25.4944 32.5523 26.7262 32.004C29.1363 30.9297 31.0008 28.7839 31.8107 26.2839C32.6432 23.7163 32.2804 20.8112 30.8602 18.5193C29.4738 16.2779 27.1396 14.6299 24.5327 14.1715C23.3375 13.9606 22.1198 14.0112 20.9105 14.0112C19.1753 14.0084 17.4374 14.0056 15.7022 14.0056C14.403 14.0028 13.1065 14.0028 11.8073 14C11.7398 14 11.6695 14 11.602 14C11.1605 14 10.7386 14.3881 10.7583 14.8437C10.7752 15.3049 11.1239 15.6902 11.5964 15.6902Z" stroke="white" />
            <path d="M18.5779 20.7182C17.827 19.9617 17.0733 19.2052 16.3225 18.4459C15.1301 17.2479 13.9405 16.0471 12.7481 14.8491C12.4725 14.5707 12.1969 14.2951 11.9213 14.0167C11.9213 14.4132 11.9213 14.8125 11.9213 15.209C12.675 14.461 13.4287 13.7129 14.1796 12.9649C15.3719 11.7809 16.5643 10.597 17.7539 9.41303C18.0267 9.14024 18.3023 8.86745 18.5751 8.59748C18.8901 8.28532 18.9097 7.71162 18.5751 7.40509C18.2376 7.09574 17.7173 7.07324 17.3827 7.40509C16.629 8.15314 15.8753 8.9012 15.1245 9.64925C13.9321 10.8332 12.7397 12.0172 11.5501 13.2011C11.2773 13.4739 11.0017 13.7467 10.7289 14.0167C10.4055 14.3373 10.4083 14.8856 10.7289 15.209C11.4798 15.9655 12.2335 16.722 12.9844 17.4813C14.1767 18.6794 15.3663 19.8802 16.5587 21.0782C16.8343 21.3566 17.1099 21.6322 17.3855 21.9106C17.6977 22.2228 18.2714 22.2453 18.5779 21.9106C18.8872 21.576 18.9097 21.0529 18.5779 20.7182Z" stroke="white" />
          </svg>
          <p>Retour</p>
        </div>
      </Link>

      <div className={styles.mail} onClick={popConnect}>
        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M24.056 17.9903C25.4741 16.8514 26.3796 15.1292 26.3796 13.2047C26.3796 9.78366 23.5178 7 20.0002 7C16.4826 7 13.6204 9.78366 13.6204 13.2047C13.6204 15.1288 14.5259 16.8514 15.944 17.9903C11.8807 19.5641 9 23.4257 9 27.9315C9 31.6726 14.926 33 20.0002 33C25.074 33 31 31.6726 31 27.9315C30.9996 23.4257 28.1189 19.5641 24.056 17.9903ZM15.8572 13.2047C15.8572 10.9832 17.7156 9.17581 19.9998 9.17581C22.284 9.17581 24.142 10.9832 24.142 13.2047C24.142 15.4262 22.284 17.2332 19.9998 17.2332C17.7156 17.2332 15.8572 15.4262 15.8572 13.2047ZM19.9998 30.8246C15.1679 30.8246 11.2368 29.5268 11.2368 27.9315C11.2368 23.2323 15.1679 19.409 19.9998 19.409C24.8317 19.409 28.7624 23.2323 28.7624 27.9315C28.7624 29.5268 24.8313 30.8246 19.9998 30.8246Z" fill="white" stroke="white" strokeWidth="0.5" />
        </svg>
        <p>{props.idLog}</p>
      </div>

      <div className={styles.actions}>
        <div className={styles.action}>
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 19.4355V28.0908C12 28.9601 12.3572 29.7938 12.9931 30.4084C13.6289 31.0231 14.4914 31.3684 15.3906 31.3684H25.6094C26.5086 31.3684 27.3711 31.0231 28.0069 30.4084C28.6428 29.7938 29 28.9601 29 28.0908V19.4355C29 19.0051 28.9123 18.5789 28.7419 18.1812C28.5715 17.7835 28.3218 17.4222 28.0069 17.1179C27.6921 16.8135 27.3183 16.5721 26.9069 16.4074C26.4956 16.2427 26.0547 16.1579 25.6094 16.1579H23.8697C23.6622 16.1579 23.4632 16.2376 23.3165 16.3794C23.1697 16.5213 23.0873 16.7137 23.0873 16.9143C23.0873 17.1149 23.1697 17.3072 23.3165 17.4491C23.4632 17.5909 23.6622 17.6706 23.8697 17.6706H25.6094C26.0936 17.6706 26.558 17.8566 26.9004 18.1875C27.2428 18.5185 27.4351 18.9674 27.4351 19.4355V28.0908C27.4351 28.5589 27.2428 29.0078 26.9004 29.3388C26.558 29.6697 26.0936 29.8557 25.6094 29.8557H15.3906C14.9064 29.8557 14.442 29.6697 14.0996 29.3388C13.7572 29.0078 13.5649 28.5589 13.5649 28.0908V19.4355C13.5649 18.9674 13.7572 18.5185 14.0996 18.1875C14.442 17.8566 14.9064 17.6706 15.3906 17.6706H17.1303C17.3378 17.6706 17.5368 17.5909 17.6835 17.4491C17.8303 17.3072 17.9127 17.1149 17.9127 16.9143C17.9127 16.7137 17.8303 16.5213 17.6835 16.3794C17.5368 16.2376 17.3378 16.1579 17.1303 16.1579H15.3906C14.4914 16.1579 13.6289 16.5032 12.9931 17.1179C12.3572 17.7325 12 18.5662 12 19.4355Z" fill="white" stroke="white" strokeWidth="1.1" />
            <path d="M20.6117 21.4916C20.7811 21.4916 20.9436 21.4257 21.0634 21.3084C21.1832 21.1911 21.2505 21.0321 21.2505 20.8662V10.9847L24.0931 13.3696C24.2227 13.4679 24.3859 13.5137 24.549 13.4974C24.7122 13.4812 24.8626 13.4041 24.9693 13.2823C25.0761 13.1604 25.1308 13.003 25.1223 12.8427C25.1137 12.6824 25.0425 12.5314 24.9235 12.421L21.0291 9.15014C20.9134 9.05325 20.7661 9 20.6139 9C20.4616 9 20.3143 9.05325 20.1986 9.15014L16.3 12.421C16.2316 12.4729 16.1747 12.5379 16.1327 12.612C16.0907 12.6861 16.0645 12.7678 16.0558 12.8521C16.047 12.9363 16.0558 13.0215 16.0817 13.1024C16.1076 13.1832 16.15 13.2581 16.2063 13.3224C16.2626 13.3867 16.3317 13.4392 16.4093 13.4766C16.487 13.514 16.5716 13.5355 16.658 13.5399C16.7444 13.5444 16.8308 13.5315 16.9121 13.5022C16.9933 13.473 17.0675 13.4278 17.1304 13.3696L19.9729 10.9847V20.8662C19.9729 21.0321 20.0402 21.1911 20.16 21.3084C20.2798 21.4257 20.4423 21.4916 20.6117 21.4916Z" fill="white" stroke="white" strokeWidth="1.2" />
          </svg>
          <p onClick={popShare}>Partager</p>
        </div>
        <Link href="/basket">
          <div className={styles.action}>
          <div className={styles.somethingInCart} style={somethingInCart.length === 0 ? {opacity:"0", transform: 'scale(0)'} : null}></div>
            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M29.3387 16.5236L24.2416 10.3083C24.103 10.1395 23.9004 10.0306 23.6783 10.0055C23.4562 9.98045 23.2328 10.0412 23.0573 10.1746C22.8818 10.3079 22.7685 10.5028 22.7425 10.7164C22.7164 10.93 22.7796 11.1448 22.9182 11.3136L27.1892 16.5236H12.1536L16.4134 11.3136C16.482 11.23 16.5328 11.1342 16.563 11.0318C16.5932 10.9293 16.602 10.8221 16.5891 10.7164C16.5762 10.6106 16.5417 10.5083 16.4877 10.4153C16.4337 10.3224 16.3612 10.2406 16.2743 10.1746C16.1874 10.1085 16.0878 10.0596 15.9813 10.0306C15.8747 10.0016 15.7633 9.99312 15.6533 10.0055C15.5433 10.018 15.437 10.0511 15.3403 10.103C15.2436 10.155 15.1586 10.2247 15.0899 10.3083L9.99282 16.5236H6.84296C6.61939 16.5236 6.40498 16.609 6.2469 16.7611C6.08881 16.9131 6 17.1193 6 17.3343C6 17.5493 6.08881 17.7555 6.2469 17.9076C6.40498 18.0596 6.61939 18.145 6.84296 18.145H8.09897L9.66968 27.2977C9.80231 28.0523 10.2082 28.7375 10.8155 29.232C11.4228 29.7265 12.1924 29.9986 12.9881 30H26.0203C26.8161 29.9986 27.5857 29.7265 28.193 29.232C28.8003 28.7375 29.2061 28.0523 29.3387 27.2977L30.901 18.1585H32.157C32.3806 18.1585 32.595 18.0731 32.7531 17.9211C32.9112 17.769 33 17.5628 33 17.3478C33 17.1328 32.9112 16.9266 32.7531 16.7746C32.595 16.6225 32.3806 16.5371 32.157 16.5371L29.3387 16.5236ZM27.6837 27.0275C27.6173 27.4055 27.4138 27.7486 27.1092 27.9959C26.8047 28.2433 26.4189 28.3789 26.0203 28.3786H12.9881C12.5895 28.3789 12.2037 28.2433 11.8992 27.9959C11.5947 27.7486 11.3911 27.4055 11.3247 27.0275L9.80737 18.1504H29.1954L27.6837 27.0275Z" fill="white" stroke="white" strokeWidth="1.4" />
            </svg>
            <p>Panier</p>
          </div>
        </Link>
      </div>
    </div>
  );

  function popShare() {
    setShareCard(!shareCard);
  }

  function popConnect() {
    setConnectionBar(!connectionBar);
  }

  function resetCard() {
    setShareCard(false);
    setConnectionBar(false);
  }

  function popCallBackMail() {
    setCallBackMail(true);
    setTimeout(() => setCallBackMail(false), 3000);
  }
};


export default HeaderCollection;
